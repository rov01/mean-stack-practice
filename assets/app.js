angular.module("app",["ngRoute"]),angular.module("app").controller("ApplicationCtrl",["$scope",function(o){o.$on("login",function(t,n){o.currentUser=n})}]),angular.module("app").controller("LoginCtrl",["$scope","UserSvc",function(o,t){o.login=function(n,e){t.login(n,e).then(function(t){o.$emit("login",t.data)})}}]),angular.module("app").controller("PostsCtrl",["$scope","$http","PostsSvc",function(o,t,n){o.addPost=function(){o.postBody&&n.create({body:o.postBody})},n.fetch().success(function(t){o.posts=t}).error(function(o){console.log("error"),console.log(o)}),o.$on("ws:new_post",function(t,n){o.$apply(function(){o.posts.unshift(n)})})}]),angular.module("app").service("PostsSvc",["$http",function(o){console.log("error"),this.fetch=function(){return o.get("/api/posts")},this.create=function(t){return o.post("/api/posts",t)}}]),angular.module("app").controller("RegisterCtrl",["$scope","UserSvc",function(o,t){o.register=function(o,n){t.register(o,n).then(function(o){console.log(o)})}}]),angular.module("app").config(["$routeProvider",function(o){o.when("/",{controller:"PostsCtrl",templateUrl:"posts.html"}).when("/register",{controller:"RegisterCtrl",templateUrl:"register.html"}).when("/login",{controller:"LoginCtrl",templateUrl:"login.html"})}]),angular.module("app").service("UserSvc",["$http",function(o){var t=this;t.getUser=function(){return o.get("/api/users")},t.login=function(n,e){return o.post("/api/sessions",{username:n,password:e}).then(function(n){return t.token=n.data,o.defaults.headers.common["X-Auth"]=n.data,t.getUser()})},t.register=function(t,n){return o.post("/api/users",{username:t,password:n})}}]),angular.module("app").run(["$rootScope",function(o){!function t(){var n="ws://localhost:3000",e=new WebSocket(n);e.onclose=function(o){console.log("Websocket closed. Reconnecting"),$timeout(t,1e4)},e.onmessage=function(t){console.log(t);var n=JSON.parse(t.data);o.$broadcast("ws:"+n.topic,n.data)}}()}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsImFwcGxpY2F0aW9uLmN0cmwuanMiLCJsb2dpbi5jdHJsLmpzIiwicG9zdHMuY3RybC5qcyIsInBvc3RzLnN2Yy5qcyIsInJlZ2lzdGVyLmN0cmwuanMiLCJyb3V0ZS5qcyIsInVzZXIuc3ZjLmpzIiwid2Vic29ja2V0LmpzIl0sIm5hbWVzIjpbImFuZ3VsYXIiLCJtb2R1bGUiLCJjb250cm9sbGVyIiwiJHNjb3BlIiwiJG9uIiwiXyIsInVzZXIiLCJjdXJyZW50VXNlciIsIlVzZXJTdmMiLCJsb2dpbiIsInVzZXJuYW1lIiwicGFzc3dvcmQiLCJ0aGVuIiwicmVzIiwiJGVtaXQiLCJkYXRhIiwiJGh0dHAiLCJQb3N0c1N2YyIsImFkZFBvc3QiLCJwb3N0Qm9keSIsImNyZWF0ZSIsImJvZHkiLCJmZXRjaCIsInN1Y2Nlc3MiLCJwb3N0cyIsImVycm9yIiwiY29uc29sZSIsImxvZyIsInBvc3QiLCIkYXBwbHkiLCJ1bnNoaWZ0Iiwic2VydmljZSIsInRoaXMiLCJnZXQiLCJyZWdpc3RlciIsImNvbmZpZyIsIiRyb3V0ZVByb3ZpZGVyIiwid2hlbiIsInRlbXBsYXRlVXJsIiwic3ZjIiwiZ2V0VXNlciIsInZhbCIsInRva2VuIiwiZGVmYXVsdHMiLCJoZWFkZXJzIiwiY29tbW9uIiwicnVuIiwiJHJvb3RTY29wZSIsImNvbm5lY3QiLCJ1cmwiLCJjb25uZWN0aW9uIiwiV2ViU29ja2V0Iiwib25jbG9zZSIsImUiLCIkdGltZW91dCIsIm9ubWVzc2FnZSIsInBheWxvYWQiLCJKU09OIiwicGFyc2UiLCIkYnJvYWRjYXN0IiwidG9waWMiXSwibWFwcGluZ3MiOiJBQUFBQSxRQUFBQyxPQUFBLE9BQUEsWUNZQUQsUUFBQUMsT0FBQSxPQUNBQyxXQUFBLG1CQUFBLFNBQUEsU0FBQUMsR0FFQUEsRUFBQUMsSUFBQSxRQUFBLFNBQUFDLEVBQUFDLEdBQ0FILEVBQUFJLFlBQUFELE9DSkFOLFFBQUFDLE9BQUEsT0FDQUMsV0FBQSxhQUFBLFNBQUEsVUFBQSxTQUFBQyxFQUFBSyxHQUVBTCxFQUFBTSxNQUFBLFNBQUFDLEVBQUFDLEdBQ0FILEVBQUFDLE1BQUFDLEVBQUFDLEdBQ0FDLEtBQUEsU0FBQUMsR0FDQVYsRUFBQVcsTUFBQSxRQUFBRCxFQUFBRSxZQ2xCQWYsUUFBQUMsT0FBQSxPQUNBQyxXQUFBLGFBQUEsU0FBQSxRQUFBLFdBQUEsU0FBQUMsRUFBQWEsRUFBQUMsR0FDQWQsRUFBQWUsUUFBQSxXQUNBZixFQUFBZ0IsVUFDQUYsRUFBQUcsUUFDQUMsS0FBQWxCLEVBQUFnQixZQUtBRixFQUFBSyxRQUNBQyxRQUFBLFNBQUFDLEdBQ0FyQixFQUFBcUIsTUFBQUEsSUFFQUMsTUFBQSxTQUFBRCxHQUNBRSxRQUFBQyxJQUFBLFNBQ0FELFFBQUFDLElBQUFILEtBR0FyQixFQUFBQyxJQUFBLGNBQUEsU0FBQUMsRUFBQXVCLEdBQ0F6QixFQUFBMEIsT0FBQSxXQUNBMUIsRUFBQXFCLE1BQUFNLFFBQUFGLFVDckJBNUIsUUFBQUMsT0FBQSxPQUNBOEIsUUFBQSxZQUFBLFFBQUEsU0FBQWYsR0FDQVUsUUFBQUMsSUFBQSxTQUNBSyxLQUFBVixNQUFBLFdBQ0EsTUFBQU4sR0FBQWlCLElBQUEsZUFHQUQsS0FBQVosT0FBQSxTQUFBUSxHQUNBLE1BQUFaLEdBQUFZLEtBQUEsYUFBQUEsT0NJQTVCLFFBQUFDLE9BQUEsT0FDQUMsV0FBQSxnQkFBQSxTQUFBLFVBQUEsU0FBQUMsRUFBQUssR0FFQUwsRUFBQStCLFNBQUEsU0FBQXhCLEVBQUFDLEdBQ0FILEVBQUEwQixTQUFBeEIsRUFBQUMsR0FDQUMsS0FBQSxTQUFBTixHQUNBb0IsUUFBQUMsSUFBQXJCLFNDTkFOLFFBQUFDLE9BQUEsT0FDQWtDLFFBQUEsaUJBQUEsU0FBQUMsR0FDQUEsRUFDQUMsS0FBQSxLQUFBbkMsV0FBQSxZQUFBb0MsWUFBQSxlQUNBRCxLQUFBLGFBQUFuQyxXQUFBLGVBQUFvQyxZQUFBLGtCQUNBRCxLQUFBLFVBQUFuQyxXQUFBLFlBQUFvQyxZQUFBLGtCQ0xBdEMsUUFBQUMsT0FBQSxPQUNBOEIsUUFBQSxXQUFBLFFBQUEsU0FBQWYsR0FDQSxHQUFBdUIsR0FBQVAsSUFDQU8sR0FBQUMsUUFBQSxXQUNBLE1BQUF4QixHQUFBaUIsSUFBQSxlQUdBTSxFQUFBOUIsTUFBQSxTQUFBQyxFQUFBQyxHQUNBLE1BQUFLLEdBQUFZLEtBQUEsaUJBQ0FsQixTQUFBQSxFQUFBQyxTQUFBQSxJQUNBQyxLQUFBLFNBQUE2QixHQUdBLE1BRkFGLEdBQUFHLE1BQUFELEVBQUExQixLQUNBQyxFQUFBMkIsU0FBQUMsUUFBQUMsT0FBQSxVQUFBSixFQUFBMUIsS0FDQXdCLEVBQUFDLGFBSUFELEVBQUFMLFNBQUEsU0FBQXhCLEVBQUFDLEdBQ0EsTUFBQUssR0FBQVksS0FBQSxjQUNBbEIsU0FBQUEsRUFBQUMsU0FBQUEsUUMxQkFYLFFBQUFDLE9BQUEsT0FDQTZDLEtBQUEsYUFBQSxTQUFBQyxJQUVBLFFBQUFDLEtBRUEsR0FBQUMsR0FBQSxzQkFDQUMsRUFBQSxHQUFBQyxXQUFBRixFQUVBQyxHQUFBRSxRQUFBLFNBQUFDLEdBQ0EzQixRQUFBQyxJQUFBLGtDQUNBMkIsU0FBQU4sRUFBQSxNQUdBRSxFQUFBSyxVQUFBLFNBQUFGLEdBQ0EzQixRQUFBQyxJQUFBMEIsRUFDQSxJQUFBRyxHQUFBQyxLQUFBQyxNQUFBTCxFQUFBdEMsS0FDQWdDLEdBQUFZLFdBQUEsTUFBQUgsRUFBQUksTUFBQUosRUFBQXpDIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXIubW9kdWxlKCdhcHAnLCBbJ25nUm91dGUnXSlcbiIsIi8qIFxuKiBAQXV0aG9yOiByb3ZlcnpvblxuKiBARGF0ZTogICAyMDE1LTA0LTE3IDE0OjQyOjU0XG4qIEBMYXN0IE1vZGlmaWVkIGJ5OiAgIHJvdmVyem9uXG4qIEBMYXN0IE1vZGlmaWVkIHRpbWU6IDIwMTUtMDQtMTcgMTQ6NDQ6MTFcbiovXG5cbi8qKlxuKiBhcHAgTW9kdWxlXG4qXG4qIERlc2NyaXB0aW9uXG4qL1xuYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uY29udHJvbGxlcignQXBwbGljYXRpb25DdHJsJywgWyckc2NvcGUnLCBmdW5jdGlvbiAoJHNjb3BlKSB7XG5cblx0JHNjb3BlLiRvbignbG9naW4nLGZ1bmN0aW9uKF8sdXNlcil7XG5cdFx0JHNjb3BlLmN1cnJlbnRVc2VyID0gdXNlclxuXHR9KVxufV0pIiwiLyogXG4qIEBBdXRob3I6IHJvdmVyem9uXG4qIEBEYXRlOiAgIDIwMTUtMDQtMTYgMTY6MDc6MTFcbiogQExhc3QgTW9kaWZpZWQgYnk6ICAgcm92ZXJ6b25cbiogQExhc3QgTW9kaWZpZWQgdGltZTogMjAxNS0wNC0xNyAxNDo1Njo0NlxuKi9cblxuLyoqXG4qIGFwcCBNb2R1bGVcbipcbiogRGVzY3JpcHRpb25cbiovXG5hbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb250cm9sbGVyKCdMb2dpbkN0cmwnLCBbJyRzY29wZScsICdVc2VyU3ZjJyAsICBmdW5jdGlvbiAoJHNjb3BlLCBVc2VyU3ZjKSB7XG5cblx0JHNjb3BlLmxvZ2luID0gZnVuY3Rpb24odXNlcm5hbWUscGFzc3dvcmQpe1xuXHRcdFVzZXJTdmMubG9naW4odXNlcm5hbWUscGFzc3dvcmQpXG5cdFx0LnRoZW4oZnVuY3Rpb24ocmVzKXtcblx0XHRcdCRzY29wZS4kZW1pdCgnbG9naW4nLHJlcy5kYXRhKVxuXHRcdH0pXG5cdH1cbn1dKSIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmNvbnRyb2xsZXIoJ1Bvc3RzQ3RybCcsIFsnJHNjb3BlJywgJyRodHRwJywgJ1Bvc3RzU3ZjJywgZnVuY3Rpb24gKCRzY29wZSwkaHR0cCwgUG9zdHNTdmMpIHtcblx0JHNjb3BlLmFkZFBvc3QgPSBmdW5jdGlvbigpe1xuXHRcdGlmICgkc2NvcGUucG9zdEJvZHkpIHtcblx0XHRcdFBvc3RzU3ZjLmNyZWF0ZSh7XG5cdFx0XHRcdGJvZHk6JHNjb3BlLnBvc3RCb2R5XG5cdFx0XHR9KVxuXHRcdH1cblx0fVxuXG5cdFBvc3RzU3ZjLmZldGNoKClcblx0LnN1Y2Nlc3MoZnVuY3Rpb24ocG9zdHMpe1xuXHRcdCRzY29wZS5wb3N0cyA9IHBvc3RzXG5cdH0pXG5cdC5lcnJvcihmdW5jdGlvbihwb3N0cykge1xuXHRcdGNvbnNvbGUubG9nKCdlcnJvcicpXG5cdFx0Y29uc29sZS5sb2cocG9zdHMpXG5cdH0pO1xuXG5cdCRzY29wZS4kb24oJ3dzOm5ld19wb3N0JyxmdW5jdGlvbihfLHBvc3Qpe1xuXHRcdCRzY29wZS4kYXBwbHkoZnVuY3Rpb24oKXtcblx0XHRcdCRzY29wZS5wb3N0cy51bnNoaWZ0KHBvc3QpXG5cdFx0fSlcblx0fSlcbn1dKSIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLnNlcnZpY2UoJ1Bvc3RzU3ZjJywgWyckaHR0cCcsIGZ1bmN0aW9uICgkaHR0cCkge1xuXHRjb25zb2xlLmxvZyhcImVycm9yXCIpXG5cdHRoaXMuZmV0Y2ggPSBmdW5jdGlvbigpe1xuXHRcdHJldHVybiAkaHR0cC5nZXQoJy9hcGkvcG9zdHMnKVxuXHR9XG5cblx0dGhpcy5jcmVhdGUgPSBmdW5jdGlvbihwb3N0KXtcblx0XHRyZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9wb3N0cycscG9zdClcblx0fVxufV0pXG4iLCIvKiBcbiogQEF1dGhvcjogcm92ZXJ6b25cbiogQERhdGU6ICAgMjAxNS0wNC0xNyAxNDoxNDowM1xuKiBATGFzdCBNb2RpZmllZCBieTogICByb3ZlcnpvblxuKiBATGFzdCBNb2RpZmllZCB0aW1lOiAyMDE1LTA0LTE3IDE0OjMzOjM5XG4qL1xuXG4vKipcbiogYXBwIE1vZHVsZVxuKlxuKiBEZXNjcmlwdGlvblxuKi9cbmFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmNvbnRyb2xsZXIoJ1JlZ2lzdGVyQ3RybCcsIFsnJHNjb3BlJywnVXNlclN2YycsIGZ1bmN0aW9uICgkc2NvcGUgLCBVc2VyU3ZjKSB7XG5cblx0JHNjb3BlLnJlZ2lzdGVyID0gZnVuY3Rpb24odXNlcm5hbWUscGFzc3dvcmQpe1xuXHRcdFVzZXJTdmMucmVnaXN0ZXIodXNlcm5hbWUscGFzc3dvcmQpXG5cdFx0LnRoZW4oZnVuY3Rpb24odXNlcil7XG5cdFx0XHRjb25zb2xlLmxvZyh1c2VyKVxuXHRcdH0pXG5cdH1cblx0XG59XSkiLCIvKiBcbiogQEF1dGhvcjogcm92ZXJ6b25cbiogQERhdGU6ICAgMjAxNS0wNC0xNiAxNDo1NDoxNlxuKiBATGFzdCBNb2RpZmllZCBieTogICByb3ZlcnpvblxuKiBATGFzdCBNb2RpZmllZCB0aW1lOiAyMDE1LTA0LTE2IDE1OjMyOjM3XG4qL1xuXG4vKipcbiogIE1vZHVsZVxuKlxuKiBEZXNjcmlwdGlvblxuKi9cbmFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmNvbmZpZyhbJyRyb3V0ZVByb3ZpZGVyJyAsIGZ1bmN0aW9uICgkcm91dGVQcm92aWRlcikge1xuXHQkcm91dGVQcm92aWRlclxuXHQud2hlbignLycsIHtjb250cm9sbGVyIDogJ1Bvc3RzQ3RybCcsdGVtcGxhdGVVcmwgOiAncG9zdHMuaHRtbCd9KVxuXHQud2hlbignL3JlZ2lzdGVyJywge2NvbnRyb2xsZXIgOiAnUmVnaXN0ZXJDdHJsJyx0ZW1wbGF0ZVVybCA6ICdyZWdpc3Rlci5odG1sJ30pXG5cdC53aGVuKCcvbG9naW4nLCB7Y29udHJvbGxlciA6ICdMb2dpbkN0cmwnLHRlbXBsYXRlVXJsIDogJ2xvZ2luLmh0bWwnfSlcbn1dKSIsIi8qIFxuKiBAQXV0aG9yOiByb3ZlcnpvblxuKiBARGF0ZTogICAyMDE1LTA0LTE2IDE2OjExOjAzXG4qIEBMYXN0IE1vZGlmaWVkIGJ5OiAgIHJvdmVyem9uXG4qIEBMYXN0IE1vZGlmaWVkIHRpbWU6IDIwMTUtMDQtMTcgMTU6MTM6MDFcbiovXG5cbi8qKlxuKiBhcHAgTW9kdWxlXG4qXG4qIERlc2NyaXB0aW9uXG4qL1xuYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uc2VydmljZSgnVXNlclN2YycsIFsnJGh0dHAnLGZ1bmN0aW9uICgkaHR0cCkge1xuXHR2YXIgc3ZjID0gdGhpc1xuXHRzdmMuZ2V0VXNlciA9IGZ1bmN0aW9uKCl7XG5cdFx0cmV0dXJuICRodHRwLmdldCgnL2FwaS91c2VycycpXG5cdH1cblxuXHRzdmMubG9naW4gPSBmdW5jdGlvbih1c2VybmFtZSxwYXNzd29yZCl7XG5cdFx0cmV0dXJuICRodHRwLnBvc3QoJy9hcGkvc2Vzc2lvbnMnLHtcblx0XHRcdHVzZXJuYW1lOiB1c2VybmFtZSAsIHBhc3N3b3JkIDogcGFzc3dvcmRcblx0XHR9KS50aGVuKGZ1bmN0aW9uKHZhbCl7XG5cdFx0XHRzdmMudG9rZW4gPSB2YWwuZGF0YVxuXHRcdFx0JGh0dHAuZGVmYXVsdHMuaGVhZGVycy5jb21tb25bJ1gtQXV0aCddID0gdmFsLmRhdGFcblx0XHRcdHJldHVybiBzdmMuZ2V0VXNlcigpXG5cdFx0fSlcblx0fVxuXG5cdHN2Yy5yZWdpc3RlciA9IGZ1bmN0aW9uKHVzZXJuYW1lLHBhc3N3b3JkKXtcblx0XHRyZXR1cm4gJGh0dHAucG9zdCgnL2FwaS91c2Vycycse1xuXHRcdFx0dXNlcm5hbWUgOiB1c2VybmFtZSAsIHBhc3N3b3JkIDogcGFzc3dvcmRcblx0XHR9KVxuXHR9XG5cbn1dKSIsIi8qKlxuKiBhcHAgTW9kdWxlXG4qXG4qIERlc2NyaXB0aW9uXG4qL1xuYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4ucnVuKFsgJyRyb290U2NvcGUnLCBmdW5jdGlvbiAoJHJvb3RTY29wZSkge1xuXHRcblx0KGZ1bmN0aW9uIGNvbm5lY3QoKXtcblxuXHRcdHZhciB1cmwgPSAnd3M6Ly9sb2NhbGhvc3Q6MzAwMCc7XG5cdFx0dmFyIGNvbm5lY3Rpb24gPSBuZXcgV2ViU29ja2V0KHVybCk7XG5cblx0XHRjb25uZWN0aW9uLm9uY2xvc2UgPSBmdW5jdGlvbihlKXtcblx0XHRcdGNvbnNvbGUubG9nKCdXZWJzb2NrZXQgY2xvc2VkLiBSZWNvbm5lY3RpbmcnKVxuXHRcdFx0JHRpbWVvdXQoY29ubmVjdCwxMCoxMDAwKVxuXHRcdH1cblxuXHRcdGNvbm5lY3Rpb24ub25tZXNzYWdlID0gZnVuY3Rpb24oZSl7XG5cdFx0XHRjb25zb2xlLmxvZyhlKVxuXHRcdFx0dmFyIHBheWxvYWQgPSBKU09OLnBhcnNlKGUuZGF0YSlcblx0XHRcdCRyb290U2NvcGUuJGJyb2FkY2FzdCgnd3M6JyArIHBheWxvYWQudG9waWMsIHBheWxvYWQuZGF0YSlcblx0XHR9XG5cdH0pKClcbn1dKSJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==